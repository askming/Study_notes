
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>[book] Causal inference in statistics a primer &#8212; Study Notes</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script src="https://wavedrom.com/skins/default.js"></script>
    <script src="https://wavedrom.com/wavedrom.min.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="[book] Data Analysis Using Regression and Multilevel/Hierarchical Models" href="Book-Data_Analysis_Using_Regression_and_Multilevel_Hierarchical_Models.html" />
    <link rel="prev" title="[book] Causal Inference: What If" href="Book-Causal%20Inference%20What%20If.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Study Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Study Notes Index (knowledge base structure)
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statistics
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Book-Analysis%20of%20Observational%20Health%20Care%20Data%20Using%20SAS.html">
   [book] Analysis of Observational Health Care Data Using SAS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Book-Causal%20Inference%20What%20If.html">
   [book] Causal Inference: What If
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   [book] Causal inference in statistics
   <em>
    a primer
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Book-Data_Analysis_Using_Regression_and_Multilevel_Hierarchical_Models.html">
   [book] Data Analysis Using Regression and Multilevel/Hierarchical Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Book-Fundamentals%20of%20Clinical%20Trials%20%284th%20edition%29.html">
   [book] Fundamentals of Clinical Trials (4th edition)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Book-Group%20Sequential%20and%20Confirmatory%20Adaptive%20Designs%20in%20Clinical%20Trials.html">
   [book] Group Sequential and Confirmatory Adaptive Designs in Clinical Trials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Book-Regression%20Modeling%20Strategies.html">
   [book] Regression Modeling Strategies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Adaptive%20Trial%20Design.html">
   Adaptive Clinical Trial Design
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Analysis%20of%20Ordinal%20Outcome.html">
   Analysis of ordinal outcome
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Analysis%20of%20Stratified%20Randomization%20Trial%20Data.html">
   Why analysis of stratified randomization trial data need to account for the stratification factors?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Association%20vs.%20Prediction%20vs.%20Causation.html">
   Association vs. Prediction vs. Causation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Baseline%20Adaptive%20Randomization.html">
   Baseline adaptive randomization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Bayesian%20optimization.html">
   Exploring Bayesian Optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Causal%20inference%20general.html">
   Causal Inference General Study Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Competing_Risk_Regression.html">
   Competing risk models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Correlated%20Data%20Analysis.html">
   Correlated/Longitudinal Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Cox_PH_model.html">
   ​Cox PH model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Dirichlet%20process.html">
   Dirichlet process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-FDA%20guidances%20for%20industry.html">
   Notes on FDA Guidances for Industry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Gaussian%20process.html">
   Gaussain Process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Group_Sequential_Trial_Design.html">
   Notes on Group Sequential Trial Design​
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-ICH%20guidelines.html">
   Notes on ICH guidelines​
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-MDD%20%26%20Effect%20size.html">
   Power,
   <strong>
    MDD
   </strong>
   /
   <strong>
    E
   </strong>
   (minimum detectable difference/effect), and
   <strong>
    Effect size
   </strong>
   in clinical trials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Meta-Analysis.html">
   Meta-analysis​
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Missing%20data.html">
   Missing data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Model%20comparison%20methods.html">
   Model comparison methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Monte%20Carlo%20method.html">
   Monte Carlo Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Multicolinearity.html">
   Multicolinearity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Multiplicity%20in%20Clinical%20Trials.html">
   Multiplicity in Clinical Trials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Non-inferiority%20equivalence%20superiority%20test.html">
   Non-inferiority/equivalence/superiority test basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Observational%20study%20design.html">
   Observational study design
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Propensity%20score%20methods.html">
   Propensity Score Methods &amp; Implementation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Quantile%20regression.html">
   Quantile regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Sample_size_calculation_with_WMW_test.html">
   Sample size calculation for the Wilcoxon-Mann-Whitney test adjusting for ties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Survival_Analysis.html">
   Survival Analysis
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statistical computing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Stats_Comp/Note-How%20R%20searches%20and%20finds%20stuff.html">
   How R searches and finds stuff
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Stats_Comp/Note-R%20notes.html">
   R study notes/tips
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Stats_Comp/Note-googleVis.html">
   Google R package googleVis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Stats_Comp/Note-matplotlib.html">
   Notes on
   <code class="docutils literal notranslate">
    <span class="pre">
     matplotlib
    </span>
   </code>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  DS/ML
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Book-Hands-On%20Machine%20Learning%20with%20Scikit-Learn%20and%20TensorFlow.html">
   [book] Hands-On Machine Learning with Scikit-Learn and TensorFlow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Book-Python%20Data%20Science%20Handbook.html">
   [book] Python Data Science Handbook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Course-Udemy-%20Python%20for%20Data%20Science%20and%20Machine%20Learning%20Bootcamp.html">
   Udemy: Python for Data Science and Machine Learning Bootcamp
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Note-Boosting.html">
   Boosting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Note-Cluster%20analysis.html">
   Cluster analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Note-Machine%20Learning%20%28General%29.html">
   ​Machine Learning (General)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Note-Naive%20Bayes.html">
   Naive Bayes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Note-Stochasitic%20Gradient%20Descent.html">
   Stochastic Gradient Decent (SGD)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Note-Tree%2C%20Random%20Forest%20%28Bagging%29.html">
   Tree/Random Forest (Bagging)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Computer science
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Course-%E5%BB%96%E9%9B%AA%E5%B3%B0python%E6%95%99%E7%A8%8B%E7%AC%94%E8%AE%B0.html">
   廖雪峰python教程笔记
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Note-HTML%20basics.html">
   HTML Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Note-Hard%20SQL%20interview%20questions.html">
   Hard Data Analyst SQL Interview Questions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Note-Inside%20look%20at%20modern%20web%20browser.html">
   Inside look at modern web browser
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Note-Learning%20React.html">
   Learning React
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Note-Learning%20Rust.html">
   Learning Rust
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Note-Modern%20JS%20explained.html">
   Modern JavaScript Explained
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Note-SQL%20Study%20Notes.html">
   SQL study notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Note-git%20and%20github.html">
   git and github
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Math
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Math/Course-Essence%20of%20linear%20algebra.html">
   Essence of linear algebra
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Miscellaneous
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Miscellaneous/Early%20managment%20of%20patients%20with%20AIS.html">
   Early management of patients with acute ischemic stroke
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Miscellaneous/Miscellaneous%20Notes.html">
   Miscellaneous Study Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Miscellaneous/Phamaceutical%20development.html">
   Pharmacedutical development
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Miscellaneous/Sim-Coin%20flip.html">
   :bulb: Q: fair coin, # of flips to get two consecutive side (H or T)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Miscellaneous/Sim-Generate%20random%20number%20between%201%20to%207.html">
   Generate random number 1 to 7 using a fair dice
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/askming/study_notes"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/askming/study_notes/issues/new?title=Issue%20on%20page%20%2FStats/Book-Causal_inference_in_statistics_a_primer.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Stats/Book-Causal_inference_in_statistics_a_primer.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-1-preliminaries-statistical-and-causal-models">
   Chapter 1 Preliminaries: Statistical and Causal Models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simpson-s-paradox">
     Simpson’s Paradox
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-1">
       Example 1
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-2">
       Example 2
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-3-segregated-data-doesn-t-give-correct-answer">
       Example 3 (segregated data doesn’t give correct answer)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-2-graphical-models-and-their-applications">
   Chapter 2 Graphical Models and Their Applications
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-3-the-effects-of-interventions">
   Chapter 3 The Effects of Interventions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interventions">
     3.1 Interventions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-adjustment-formula">
     3.2 The Adjustment Formula
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#to-adjust-or-not-to-adjust">
       3.2.1 To Adjust or not to Adjust
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#multiple-interventions-and-the-truncated-product-rule">
       3.2.2 Multiple Interventions and the Truncated Product Rule
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-backdoor-criterion">
     3.3 The Backdoor Criterion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-front-door-criterion">
     3.4 The Front-Door Criterion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conditional-interventions-and-covariate-specific-effects">
     3.5 Conditional Interventions and Covariate-Specific Effects
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inverse-probability-weighing">
     3.6 Inverse Probability Weighing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mediation">
     3.7 Mediation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#causual-inference-in-linear-systems">
     3.8 Causual Inference in Linear Systems
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#structual-vesus-regression-coefficients">
       3.8.1 Structual vesus Regression Coefficients
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-causal-interpretation-of-structural-coefficients">
       3.8.2 The Causal Interpretation of Structural Coefficients
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#indentifying-structural-coefficients-and-causal-effect">
       3.8.3 Indentifying Structural Coefficients and Causal Effect
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mediation-in-linear-systems">
       3.8.4 Mediation in Linear Systems
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>[book] Causal inference in statistics a primer</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-1-preliminaries-statistical-and-causal-models">
   Chapter 1 Preliminaries: Statistical and Causal Models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simpson-s-paradox">
     Simpson’s Paradox
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-1">
       Example 1
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-2">
       Example 2
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-3-segregated-data-doesn-t-give-correct-answer">
       Example 3 (segregated data doesn’t give correct answer)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-2-graphical-models-and-their-applications">
   Chapter 2 Graphical Models and Their Applications
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-3-the-effects-of-interventions">
   Chapter 3 The Effects of Interventions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interventions">
     3.1 Interventions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-adjustment-formula">
     3.2 The Adjustment Formula
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#to-adjust-or-not-to-adjust">
       3.2.1 To Adjust or not to Adjust
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#multiple-interventions-and-the-truncated-product-rule">
       3.2.2 Multiple Interventions and the Truncated Product Rule
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-backdoor-criterion">
     3.3 The Backdoor Criterion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-front-door-criterion">
     3.4 The Front-Door Criterion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conditional-interventions-and-covariate-specific-effects">
     3.5 Conditional Interventions and Covariate-Specific Effects
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inverse-probability-weighing">
     3.6 Inverse Probability Weighing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mediation">
     3.7 Mediation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#causual-inference-in-linear-systems">
     3.8 Causual Inference in Linear Systems
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#structual-vesus-regression-coefficients">
       3.8.1 Structual vesus Regression Coefficients
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-causal-interpretation-of-structural-coefficients">
       3.8.2 The Causal Interpretation of Structural Coefficients
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#indentifying-structural-coefficients-and-causal-effect">
       3.8.3 Indentifying Structural Coefficients and Causal Effect
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mediation-in-linear-systems">
       3.8.4 Mediation in Linear Systems
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="book-causal-inference-in-statistics-a-primer">
<h1>[book] Causal inference in statistics <em>a primer</em><a class="headerlink" href="#book-causal-inference-in-statistics-a-primer" title="Permalink to this headline">#</a></h1>
<hr>
<p><em>a study note of <span id="id1">[<a class="reference internal" href="#id10" title="Judea Pearl, Madelyn Glymour, and Nicholas P Jewell. Causal inference in statistics: A primer. John Wiley &amp; Sons, 2016.">Pearl <em>et al.</em>, 2016</a>]</span></em></p>
<section id="chapter-1-preliminaries-statistical-and-causal-models">
<h2>Chapter 1 Preliminaries: Statistical and Causal Models<a class="headerlink" href="#chapter-1-preliminaries-statistical-and-causal-models" title="Permalink to this headline">#</a></h2>
<section id="simpson-s-paradox">
<h3>Simpson’s Paradox<a class="headerlink" href="#simpson-s-paradox" title="Permalink to this headline">#</a></h3>
<blockquote>
<div><p>The paradox refers to the existence of data in which a statistical association that holds for an entire popu- lation is reversed in every subpopulation.</p>
</div></blockquote>
<section id="example-1">
<h4>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">#</a></h4>
<p><img alt="输入图片描述" src="https://raw.githubusercontent.com/askming/picgo/master/3a11164d_20200421090218.png" /></p>
<p>The first row shows the outcome for male patients; the second row shows the outcome for female patients; and the third row shows the outcome for all patients, regardless of gender. In male patients, drug takers had a better recovery rate than those who went without the drug (93% vs 87%). In female patients, again, those who took the drug had a better recovery rate than nontakers (73% vs 69%). However, in the combined population, those who did not take the drug had a better recovery rate than those who did (83% vs 78%).</p>
<p><strong>Explaination:</strong></p>
<blockquote>
<div><p>As we can see from the data, women are significantly more likely to take the drug than men are (<em>i.e. there is gender imbalance in the two treatment arm</em>). So, the reason the drug appears to be harmful overall is that, if we select a drug user at random, that person is more likely to be a woman and hence less likely to recover than a random person who does not take the drug.
Put differently, being a woman is a common cause of both drug taking and failure to recover. Therefore, to assess the effectiveness, we need to compare subjects of the same gender <em>(i.e. control for gender</em>), thereby ensuring that any difference in recovery rates between those who take the drug and those who do not is not ascribable to estrogen.</p>
</div></blockquote>
</section>
<section id="example-2">
<h4>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">#</a></h4>
<p><img alt="输入图片描述" src="https://raw.githubusercontent.com/askming/picgo/master/af05e8f9_20200421110946.png" /></p>
<p>We see that there is a general trend downward in each group; the more young people exercise, the lower their cholesterol is, and the same applies for middle-aged people and the elderly.
<img alt="输入图片描述" src="https://raw.githubusercontent.com/askming/picgo/master/d7c225ea_20200421111024.png" /></p>
<p>However, we use the same scatter plot, but we don’t segregate by gender (as in Figure 1.2), we see a general trend upward; the more a person exercises, the higher their cholesterol is.</p>
<p><strong>Explaination:</strong></p>
<blockquote>
<div><p>Older people, who are more likely to exercise (Figure 1.1), are also more likely to have high cholesterol regardless of exercise, then the reversal is easily explained, and easily resolved. Age is a common cause of both treatment (exercise) and outcome (cholesterol). So we should look at the age-segregated data in order to compare same-age people and thereby eliminate the possibility that the high exercisers in each group we examine are more likely to have high cholesterol due to their age, and not due to exercising.</p>
</div></blockquote>
</section>
<section id="example-3-segregated-data-doesn-t-give-correct-answer">
<h4>Example 3 (segregated data doesn’t give correct answer)<a class="headerlink" href="#example-3-segregated-data-doesn-t-give-correct-answer" title="Permalink to this headline">#</a></h4>
<p><img alt="输入图片描述" src="https://raw.githubusercontent.com/askming/picgo/master/49d255fb_20200421111052.png" /></p>
<p>we looked at the same numbers from our first example of drug taking and recovery, instead of recording participants’ gender, patients’ blood pressure were recorded <strong>at the end of the experiment</strong>. In this case, we know that the drug affects recovery by lowering the blood pressure of those who take it—but unfortunately, it also has a toxic effect. At the end of our experiment, we receive the results shown in Table 1.2. (Table 1.2 is numerically identical to Table 1.1, with the exception of the column labels, which have been switched.)</p>
<p><strong>Explaination:</strong></p>
<blockquote>
<div><p>In the general population, the drug might improve recovery rates because of its effect on blood pressure. But in the subpopulations—the group of people whose posttreatment BP is high and the group whose posttreatment BP is low—we, of course, would not see that effect; we would only see the drug’s toxic effect.
Treatment –&gt; blood pressure –&gt; outcome, conditional on blood pressure will remove the treatment effect on the outcome</p>
</div></blockquote>
<ul class="simple">
<li><p>There is, in fact, no way to represent any causal information in contingency tables (such as Tables 1.1 and 1.2), on which statistical inference is often based. (why? is it because contingency tables can only represent association instead of causation?)</p></li>
<li><p>In order to rigorously approach our understanding of the causal story behind data, we need four things:</p>
<ul>
<li><p>A working definition of “causation.” (<strong>A variable X is a cause of a variable Y if Y in any way relies on X for its value.</strong>  or <strong>X is a cause of Y if Y listens to X and decides its value in response to what it hears.</strong>)</p></li>
<li><p>A method by which to formally articulate causal assumptions—that is, to create causal models.</p></li>
<li><p>A method by which to link the structure of a causal model to features of data.</p></li>
<li><p>A method by which to draw conclusions from the combination of causal assumptions embedded in a model and data.</p></li>
</ul>
</li>
</ul>
<hr>
</section>
</section>
</section>
<section id="chapter-2-graphical-models-and-their-applications">
<h2>Chapter 2 Graphical Models and Their Applications<a class="headerlink" href="#chapter-2-graphical-models-and-their-applications" title="Permalink to this headline">#</a></h2>
<hr>
</section>
<section id="chapter-3-the-effects-of-interventions">
<h2>Chapter 3 The Effects of Interventions<a class="headerlink" href="#chapter-3-the-effects-of-interventions" title="Permalink to this headline">#</a></h2>
<section id="interventions">
<h3>3.1 Interventions<a class="headerlink" href="#interventions" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>When we <em>intervene</em> on a variable in a model, we fix its value. We change the system, and the values of other variables often change as a result. When we <em>condition</em> on a variable, we change nothing; we merely narrow our focus to the subset of cases in which the variable takes the value we are interested in.</p></li>
<li><p>When we intervene to fix the value of a variable, we curtail the natural tendency of that variable to vary in response to other variables in nature. This amounts to performing a kind of surgery on the graphical model, removing all edges directed into that variable.</p></li>
<li><p>Intervening on a variable results in a totally different pattern of dependencies than conditioning on a variable. Moreover, the latter can be obtained directly from the data set; while the former varies depending on the structure of the causal graph.</p></li>
<li><p>In notation, we distinguish between cases where a variable <span class="math notranslate nohighlight">\(X\)</span> takes a value <span class="math notranslate nohighlight">\(x\)</span> naturally and cases where we fix <span class="math notranslate nohighlight">\(X = x\)</span> by denoting the latter <span class="math notranslate nohighlight">\(do(X = x)\)</span>. So <span class="math notranslate nohighlight">\(P(Y = y|X = x)\)</span> is the probability that <span class="math notranslate nohighlight">\(Y = y\)</span> conditional on finding <span class="math notranslate nohighlight">\(X = x\)</span>, while <span class="math notranslate nohighlight">\(P(Y = y|do(X = x))\)</span> is the probability that <span class="math notranslate nohighlight">\(Y = y\)</span> when we <em>intervene</em> to make <span class="math notranslate nohighlight">\(X = x\)</span>.</p>
<ul>
<li><p>In the distributional terminology, <span class="math notranslate nohighlight">\(P(Y = y|X = x)\)</span> reflects the population distribution of <span class="math notranslate nohighlight">\(Y\)</span> among individuals whose <span class="math notranslate nohighlight">\(X\)</span> value is <span class="math notranslate nohighlight">\(x\)</span>. On the other hand, <span class="math notranslate nohighlight">\(P(Y = y|do(X = x))\)</span> represents the population distribution of <span class="math notranslate nohighlight">\(Y\)</span> <em>if everyone in the population</em> had their <span class="math notranslate nohighlight">\(X\)</span> value fixed at <span class="math notranslate nohighlight">\(x\)</span>. We similarly write <span class="math notranslate nohighlight">\(P(Y = y|do(X = x), Z = z)\)</span> to denote the conditional probability of <span class="math notranslate nohighlight">\(Y = y\)</span>, given <span class="math notranslate nohighlight">\(Z = z\)</span>, in the distribution created by the intervention <span class="math notranslate nohighlight">\(do(X = x)\)</span>.</p></li>
</ul>
</li>
<li><p>It is worth noting here that we are making a tacit assumption here that the intervention has no “side effects,” that is, that assigning the value <span class="math notranslate nohighlight">\(x\)</span> for the valuable <span class="math notranslate nohighlight">\(X\)</span> for an individual does not alter subsequent variables in a direct way.</p></li>
</ul>
</section>
<section id="the-adjustment-formula">
<h3>3.2 The Adjustment Formula<a class="headerlink" href="#the-adjustment-formula" title="Permalink to this headline">#</a></h3>
<ul>
<li><p>Denoting the first intervention by <span class="math notranslate nohighlight">\(do(X = 1)\)</span> and the second by <span class="math notranslate nohighlight">\(do(X = 0)\)</span>, our task is to estimate the difference
$<span class="math notranslate nohighlight">\(P(Y = 1|do(X = 1)) − P(Y = 1|do(X = 0))\)</span>$
which is known as the “<strong>causal effect difference</strong>,” or “<strong>average causal effect</strong>” (ACE).</p></li>
<li><p>The causal effect <span class="math notranslate nohighlight">\(P(Y = y|do(X = x))\)</span> is equal to the conditional probability <span class="math notranslate nohighlight">\(P_m(Y = y|X = x)\)</span> that prevails in the manipulated model of Figure 3.4.<br />
<img alt="输入图片描述" src="https://raw.githubusercontent.com/askming/picgo/master/9aef4d0e_20200421111120.png" /></p>
<ul>
<li><p>the marginal probability <span class="math notranslate nohighlight">\(P(Z = z)\)</span> is invariant under the intervention, because the process determining <span class="math notranslate nohighlight">\(Z\)</span> is not affected by removing the arrow from <span class="math notranslate nohighlight">\(Z\)</span> to <span class="math notranslate nohighlight">\(X\)</span>.</p></li>
<li><p>the conditional probability <span class="math notranslate nohighlight">\(P(Y = y|Z = z, X = x)\)</span> is invariant, because the process by which <span class="math notranslate nohighlight">\(Y\)</span> responds to <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z, Y = f (x, z, u_Y )\)</span>, remains the same, regardless of whether <span class="math notranslate nohighlight">\(X\)</span> changes spontaneously or by deliberate manipulation. We can therefore write two equations of invariance:
$<span class="math notranslate nohighlight">\(P_m(Y=y|Z=z,X=x)=P(Y=y|Z=z,X=x) \text{ and } P_m(Z=z)=P(Z=z)\)</span>$</p></li>
<li><p>using the invariance relations, we obtain a formula for the causal effect, in terms of preintervention probabilities:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
        \begin{align}
        P(Y = y|do(X = x)) &amp; = P_m(Y = y|X = x)\\
        &amp; = \sum_z P_m(Y = y|X = x,Z = z)P_m(Z = z|X = x)\\
        &amp; = \sum_z P_m(Y = y|X = x,Z = z)P_m(Z = z)\\
        &amp; = \sum_z P(Y = y|X = x, Z = z)P(Z = z)
        \end{align}
        \end{split}\]</div>
<ul class="simple">
<li><p>This is called the <em>adjustment formula</em>, it computes the association between X and <span class="math notranslate nohighlight">\(Y\)</span> for each value <span class="math notranslate nohighlight">\(z\)</span> of <span class="math notranslate nohighlight">\(Z\)</span>, then averages over those values. This procedure is referred to as “<strong>adjusting for <span class="math notranslate nohighlight">\(Z\)</span></strong>” or “<strong>controlling for <span class="math notranslate nohighlight">\(Z\)</span></strong>”.</p></li>
<li><p>No adjustment is needed in a randomized controlled experiment since, in such a setting, the data are generated by a model which already possesses the structure of Figure 3.4, hence, <span class="math notranslate nohighlight">\(P_m = P\)</span> regardless of any factors <span class="math notranslate nohighlight">\(Z\)</span> that affect <span class="math notranslate nohighlight">\(Y\)</span>.</p></li>
<li><p>In practice, investigators use adjustments in randomized experiments as well, for the purpose of <em>minimizing sampling variations</em> (Cox 1958)</p></li>
</ul>
</li>
<li><p>The graph of Figure 3.5 shows no arrow entering X, since X has no parents. This means that no surgery is required; the conditions under which data were obtained were such that treatment was assigned “as if randomized.” If there was a factor that would make subjects prefer or reject treatment, such a factor should show up in the model; the absence of such a factor gives us the license to treat X as a randomized treatment.
<img alt="输入图片描述" src="https://raw.githubusercontent.com/askming/picgo/master/1dbc495f_20200421111147.png" /></p>
<ul>
<li><p>Under such conditions, the intervention graph is equal to the original graph—no arrow need be removed—and the adjustment formula reduces to</p>
<div class="math notranslate nohighlight">
\[P(Y = y|do(X = x)) = P(Y = y|X = x)\]</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<section id="to-adjust-or-not-to-adjust">
<h4>3.2.1 To Adjust or not to Adjust<a class="headerlink" href="#to-adjust-or-not-to-adjust" title="Permalink to this headline">#</a></h4>
<ul>
<li><p><strong>The Causal Effect Rule</strong>: Given a graph G in which a set of variables PA are designated
as the parents of <span class="math notranslate nohighlight">\(X\)</span>, the causal effect of <span class="math notranslate nohighlight">\(X\)</span> on <span class="math notranslate nohighlight">\(Y\)</span> is given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-4e978c58-eced-48e3-bfa3-a46683b346fc">
<span class="eqno">(3)<a class="headerlink" href="#equation-4e978c58-eced-48e3-bfa3-a46683b346fc" title="Permalink to this equation">#</a></span>\[\begin{align}
  P(Y = y| do(X = x)) &amp; = \sum_z P(Y = y | X = x, PA = z) P(PA = z)\\
  &amp; = \sum_z \frac{P(Y = y | X = x, PA = z) P(PA = z) * P(X=x|PA = z)}{P(X=x|PA = z)}\\
  &amp; = \sum_z \frac{P(Y = y, X = x, PA = z)}{P(X=x|PA = z)}
  \end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(z\)</span> ranges over all the combinations of values that the variables in PA can take and <span class="math notranslate nohighlight">\(P(X=x|PA = z)\)</span> is the <em>propensity score</em>.</p>
</li>
</ul>
</section>
<section id="multiple-interventions-and-the-truncated-product-rule">
<h4>3.2.2 Multiple Interventions and the Truncated Product Rule<a class="headerlink" href="#multiple-interventions-and-the-truncated-product-rule" title="Permalink to this headline">#</a></h4>
<div class="amsmath math notranslate nohighlight" id="equation-363b9f0e-8848-4dcd-a5e3-be1d671f1be4">
<span class="eqno">(4)<a class="headerlink" href="#equation-363b9f0e-8848-4dcd-a5e3-be1d671f1be4" title="Permalink to this equation">#</a></span>\[\begin{align}
P(x, y, z) &amp; = P(z)P(x|z)P(y|x, z)\\
P(z, y|do(x)) &amp; = P_m(z)P_m(y|x, z) = P(z)P(y|x, z)\\
\Rightarrow
P(z, y|do(x)) &amp; = \frac{P(x, y, z)}{P(x|z)}
\end{align}\]</div>
<ul class="simple">
<li><p>It tells us that the conditional probability <span class="math notranslate nohighlight">\(P(x|z)\)</span> is all we need to know in order to predict the effect of an intervention <span class="math notranslate nohighlight">\(do(x)\)</span> from nonexperimental data governed by the distribution <span class="math notranslate nohighlight">\(P(x, y, z)\)</span>.</p></li>
</ul>
</section>
</section>
<section id="the-backdoor-criterion">
<h3>3.3 The Backdoor Criterion<a class="headerlink" href="#the-backdoor-criterion" title="Permalink to this headline">#</a></h3>
<ul>
<li><p><em>Challenge</em>: variables may have unmeasured parents that, though represented in the graph, may be inaccessible for measurement. In those cases, we need to find an alternative set of variables to adjust for.</p></li>
<li><p><em>Question</em>: Under what conditions does a causal story permit us to compute the causal effect of one variable on another, from data obtained by passive observations, with no interventions? (Under what conditions, is the structure of the causal graph sufficient for computing a causal effect from a given data set?)</p></li>
<li><p><em>Solution</em>: one of the most important tools we use to determine whether we can compute a causal effect is a simple test called the <strong>backdoor criterion</strong>. Using it, we can determine whether, for any two variables <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> in a causal model represented by a DAG, which set of variables <span class="math notranslate nohighlight">\(Z\)</span> in that model should be conditioned on when searching for the causal relationship between <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<ul class="simple">
<li><p><strong>Definition (The Backdoor Criterion)</strong>: Given an ordered pair of variables <span class="math notranslate nohighlight">\((X, Y)\)</span> in a directed acyclic graph <span class="math notranslate nohighlight">\(G\)</span>, a set of variables <span class="math notranslate nohighlight">\(Z\)</span> satisfies the backdoor criterion relative to <span class="math notranslate nohighlight">\((X, Y)\)</span> if no node in <span class="math notranslate nohighlight">\(Z\)</span> is a descendant of <span class="math notranslate nohighlight">\(X\)</span>, and <span class="math notranslate nohighlight">\(Z\)</span> blocks every path between <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> that contains an arrow into <span class="math notranslate nohighlight">\(X\)</span>.</p></li>
<li><p>If a set of variables <span class="math notranslate nohighlight">\(Z\)</span> satisfies the backdoor criterion for <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>, then the causal effect of <span class="math notranslate nohighlight">\(X\)</span> on <span class="math notranslate nohighlight">\(Y\)</span> is given by the formula</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
  P(Y = y|do(X = x)) = \sum_z P(Y = y|X = x, Z = z)P(Z = z)
  \]</div>
<ul>
<li><p>When trying to find the causal effect of <span class="math notranslate nohighlight">\(X\)</span> on <span class="math notranslate nohighlight">\(Y\)</span>, we want the nodes we condition on to block any “backdoor” path in which one end has an arrow into <span class="math notranslate nohighlight">\(X\)</span>, because such paths may make <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> dependent, but are obviously not transmitting causal influences from <span class="math notranslate nohighlight">\(X\)</span>, and if we do not block them, they will confound the effect that <span class="math notranslate nohighlight">\(X\)</span> has on <span class="math notranslate nohighlight">\(Y\)</span>.</p></li>
<li><p>Consider the fact that <span class="math notranslate nohighlight">\(P(Y = y|do(X = x))\)</span> is an empirical fact of nature, not a byproduct of our analysis. That means that any suitable variable or set of variables that we adjust on—whether it be <span class="math notranslate nohighlight">\(PA(X)\)</span> or any other set that conforms to the backdoor criterion—must return the same result for <span class="math notranslate nohighlight">\(P(Y = y|do(X = x))\)</span>. In the case we looked at in Figure 3.6 (<span class="math notranslate nohighlight">\(Y \leftarrow X \leftarrow Z \rightarrow W \rightarrow Y\)</span>), this means that</p>
<div class="amsmath math notranslate nohighlight" id="equation-2347b290-8bd2-4009-bbd2-159d758d8429">
<span class="eqno">(5)<a class="headerlink" href="#equation-2347b290-8bd2-4009-bbd2-159d758d8429" title="Permalink to this equation">#</a></span>\[\begin{align}
    &amp;&amp; \sum_w P(Y = y|X = x,W = w)P(W = w) \\
    &amp;&amp; = \sum_z P(Y = y|X = x, Z = z)P(Z = z)
    \end{align}\]</div>
<ul class="simple">
<li><p>In the cases where we have multiple observed sets of variables suitable for adjustment (e.g., in Figure 3.6, if both W and Z had been observed), it provides us with a choice of which variables to adjust for.</p></li>
<li><p>The equality constitutes a testable constraint on the data when all the adjustment variables are observed, much like the rules of <span class="math notranslate nohighlight">\(d\)</span>-separation.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="the-front-door-criterion">
<h3>3.4 The Front-Door Criterion<a class="headerlink" href="#the-front-door-criterion" title="Permalink to this headline">#</a></h3>
<ul>
<li><p><em>Problem</em>: The backdoor criterion provides us with a simple method of identifying sets of covariates that should be adjusted for when we seek to estimate causal effects from nonexperimental data. It does not, however, exhaust all ways of estimating such effects. The <span class="math notranslate nohighlight">\(do\)</span>-operator can be applied to graphical patterns that do not satisfy the backdoor criterion to identify effects that on first sight seem to be beyond one’s reach.</p></li>
<li><p>The <strong>front-door</strong> formula</p>
<div class="amsmath math notranslate nohighlight" id="equation-5dcb0595-6720-4474-80eb-741a5564e628">
<span class="eqno">(6)<a class="headerlink" href="#equation-5dcb0595-6720-4474-80eb-741a5564e628" title="Permalink to this equation">#</a></span>\[\begin{align}
  P(Y =y | do(X = x)) = \\
  \sum_z\sum_x' P(Y = y | Z = z, X = x') P(X = x') P(Z = z|X = x) 
  \end{align}\]</div>
</li>
<li><p><strong>Definition (Front-Door)</strong> A set of variables <span class="math notranslate nohighlight">\(Z\)</span> is said to satisfy the front-door criterion relative to an ordered pair of variables <span class="math notranslate nohighlight">\((X, Y)\)</span> if</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(Z\)</span> intercepts all directed paths from <span class="math notranslate nohighlight">\(X\)</span> to <span class="math notranslate nohighlight">\(Y\)</span>.</p></li>
<li><p>There is no unblocked path from <span class="math notranslate nohighlight">\(X\)</span> to <span class="math notranslate nohighlight">\(Z\)</span>.</p></li>
<li><p>All backdoor paths from <span class="math notranslate nohighlight">\(Z\)</span> to <span class="math notranslate nohighlight">\(Y\)</span> are blocked by <span class="math notranslate nohighlight">\(X\)</span>.</p></li>
</ol>
<ul>
<li><p><strong>Theorem (Front-Door Adjustment)</strong> If <span class="math notranslate nohighlight">\(Z\)</span> satisfies the front-door criterion relative to <span class="math notranslate nohighlight">\((X, Y)\)</span> and if <span class="math notranslate nohighlight">\(P(x, z) &gt; 0\)</span>, then the causal effect of <span class="math notranslate nohighlight">\(X\)</span> on <span class="math notranslate nohighlight">\(Y\)</span> is identifiable and is given by the formula</p>
<div class="math notranslate nohighlight">
\[P(y|do(x)) = \sum_z P(z|x) \sum_{x′} P(y|x′, z)P(x′)\]</div>
</li>
</ul>
</li>
</ul>
</section>
<section id="conditional-interventions-and-covariate-specific-effects">
<h3>3.5 Conditional Interventions and Covariate-Specific Effects<a class="headerlink" href="#conditional-interventions-and-covariate-specific-effects" title="Permalink to this headline">#</a></h3>
</section>
<section id="inverse-probability-weighing">
<h3>3.6 Inverse Probability Weighing<a class="headerlink" href="#inverse-probability-weighing" title="Permalink to this headline">#</a></h3>
</section>
<section id="mediation">
<h3>3.7 Mediation<a class="headerlink" href="#mediation" title="Permalink to this headline">#</a></h3>
</section>
<section id="causual-inference-in-linear-systems">
<h3>3.8 Causual Inference in Linear Systems<a class="headerlink" href="#causual-inference-in-linear-systems" title="Permalink to this headline">#</a></h3>
<section id="structual-vesus-regression-coefficients">
<h4>3.8.1 Structual vesus Regression Coefficients<a class="headerlink" href="#structual-vesus-regression-coefficients" title="Permalink to this headline">#</a></h4>
</section>
<section id="the-causal-interpretation-of-structural-coefficients">
<h4>3.8.2 The Causal Interpretation of Structural Coefficients<a class="headerlink" href="#the-causal-interpretation-of-structural-coefficients" title="Permalink to this headline">#</a></h4>
</section>
<section id="indentifying-structural-coefficients-and-causal-effect">
<h4>3.8.3 Indentifying Structural Coefficients and Causal Effect<a class="headerlink" href="#indentifying-structural-coefficients-and-causal-effect" title="Permalink to this headline">#</a></h4>
</section>
<section id="mediation-in-linear-systems">
<h4>3.8.4 Mediation in Linear Systems<a class="headerlink" href="#mediation-in-linear-systems" title="Permalink to this headline">#</a></h4>
<div class="docutils container" id="id2">
<dl class="citation">
<dt class="label" id="id10"><span class="brackets"><a class="fn-backref" href="#id1">PGJ16</a></span></dt>
<dd><p>Judea Pearl, Madelyn Glymour, and Nicholas P Jewell. <em>Causal inference in statistics: A primer</em>. John Wiley &amp; Sons, 2016.</p>
</dd>
</dl>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Stats"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>
    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Book-Causal%20Inference%20What%20If.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">[book] Causal Inference: What If</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Book-Data_Analysis_Using_Regression_and_Multilevel_Hierarchical_Models.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">[book] Data Analysis Using Regression and Multilevel/Hierarchical Models</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Ming Yang<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>