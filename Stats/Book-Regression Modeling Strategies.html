

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>[book] Regression Modeling Strategies &#8212; Study Notes</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script src="https://wavedrom.com/skins/default.js"></script>
    <script src="https://wavedrom.com/wavedrom.min.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://unpkg.com/mermaid@9.4.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Stats/Book-Regression Modeling Strategies';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Adaptive Clinical Trial Design" href="Note-Adaptive%20Trial%20Design.html" />
    <link rel="prev" title="[book] Group Sequential and Confirmatory Adaptive Designs in Clinical Trials" href="Book-Group%20Sequential%20and%20Confirmatory%20Adaptive%20Designs%20in%20Clinical%20Trials.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Study Notes Index (knowledge base structure)
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Book-Analysis%20of%20Observational%20Health%20Care%20Data%20Using%20SAS.html">[book] Analysis of Observational Health Care Data Using SAS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Book-Causal%20Inference%20What%20If.html">[book] Causal Inference: What If</a></li>
<li class="toctree-l1"><a class="reference internal" href="Book-Causal_inference_in_statistics_a_primer.html">[book] Causal inference in statistics <em>a primer</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="Book-Data_Analysis_Using_Regression_and_Multilevel_Hierarchical_Models.html">[book] Data Analysis Using Regression and Multilevel/Hierarchical Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="Book-Fundamentals%20of%20Clinical%20Trials%20%284th%20edition%29.html">[book] Fundamentals of Clinical Trials (4th edition)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Book-Group%20Sequential%20and%20Confirmatory%20Adaptive%20Designs%20in%20Clinical%20Trials.html">[book] Group Sequential and Confirmatory Adaptive Designs in Clinical Trials</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">[book] Regression Modeling Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Adaptive%20Trial%20Design.html">Adaptive Clinical Trial Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Analysis%20of%20Ordinal%20Outcome.html">Analysis of ordinal outcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Analysis%20of%20Stratified%20Randomization%20Trial%20Data.html">Why analysis of stratified randomization trial data need to account for the stratification factors?</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Association%20vs.%20Prediction%20vs.%20Causation.html">Association vs. Prediction vs. Causation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Baseline%20Adaptive%20Randomization.html">Baseline adaptive randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Bayesian%20optimization.html">Exploring Bayesian Optimization</a></li>

<li class="toctree-l1"><a class="reference internal" href="Note-Causal%20inference%20general.html">Causal Inference General Study Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Competing_Risk_Regression.html">Competing risk models</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Correlated%20Data%20Analysis.html">Correlated/Longitudinal Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Cox_PH_model.html">​Cox PH model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Dirichlet%20process.html">Dirichlet process</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-FDA%20guidances%20for%20industry.html">Notes on FDA Guidances for Industry</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Gaussian%20process.html">Gaussain Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Group_Sequential_Trial_Design.html">Notes on Group Sequential Trial Design​</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-ICH%20guidelines.html">Notes on ICH guidelines​</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-MDD%20%26%20Effect%20size.html">Power, <strong>MDD</strong>/<strong>E</strong> (minimum detectable difference/effect), and <strong>Effect size</strong> in clinical trials</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Meta-Analysis.html">Meta-analysis​</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Missing%20data.html">Missing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Model%20comparison%20methods.html">Model comparison methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Monte%20Carlo%20method.html">Monte Carlo Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Multicolinearity.html">Multicolinearity</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Multiplicity%20in%20Clinical%20Trials.html">Multiplicity in Clinical Trials</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Non-inferiority%20equivalence%20superiority%20test.html">Non-inferiority/equivalence/superiority test basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Observational%20study%20design.html">Observational study design</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Propensity%20score%20methods.html">Propensity Score Methods &amp; Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Quantile%20regression.html">Quantile regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Sample_size_calculation_with_WMW_test.html">Sample size calculation for the Wilcoxon-Mann-Whitney test adjusting for ties</a></li>
<li class="toctree-l1"><a class="reference internal" href="Note-Survival_Analysis.html">Survival Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="%C2%A0Note-Trimmed%20means%20analysis.html">Trimmed means analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistical computing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Stats_Comp/Note-How%20R%20searches%20and%20finds%20stuff.html">How R searches and finds stuff</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Stats_Comp/Note-Pandas.html">Pandas study note</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Stats_Comp/Note-R%20notes.html">R study notes/tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Stats_Comp/Note-googleVis.html">Google R package googleVis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Stats_Comp/Note-matplotlib.html">Notes on <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DS/ML</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../DS_ML/Book-Hands-On%20Machine%20Learning%20with%20Scikit-Learn%20and%20TensorFlow.html">[book] Hands-On Machine Learning with Scikit-Learn and TensorFlow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DS_ML/Book-Python%20Data%20Science%20Handbook.html">[book] Python Data Science Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DS_ML/Course-Udemy-%20Python%20for%20Data%20Science%20and%20Machine%20Learning%20Bootcamp.html">Udemy: Python for Data Science and Machine Learning Bootcamp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DS_ML/Note-Boosting.html">Boosting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DS_ML/Note-Cluster%20analysis.html">Cluster analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DS_ML/Note-Machine%20Learning%20%28General%29.html">​Machine Learning (General)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DS_ML/Note-Naive%20Bayes.html">Naive Bayes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DS_ML/Note-Stochasitic%20Gradient%20Descent.html">Stochastic Gradient Decent (SGD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DS_ML/Note-Tree%2C%20Random%20Forest%20%28Bagging%29.html">Tree/Random Forest (Bagging)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computer science</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../CS/Course-%E5%BB%96%E9%9B%AA%E5%B3%B0python%E6%95%99%E7%A8%8B%E7%AC%94%E8%AE%B0.html">廖雪峰python教程笔记</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CS/Note-HTML%20basics.html">HTML Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CS/Note-Hard%20SQL%20interview%20questions.html">Hard Data Analyst SQL Interview Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CS/Note-Inside%20look%20at%20modern%20web%20browser.html">Inside look at modern web browser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CS/Note-Learning%20React.html">Learning React</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CS/Note-Learning%20Rust.html">Learning Rust</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CS/Note-Modern%20JS%20explained.html">Modern JavaScript Explained</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CS/Note-Python%20numpy.html">Numpy study notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CS/Note-SQL%20Study%20Notes.html">SQL study notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CS/Note-git%20and%20github.html">git and github</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Math</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Math/Course-Essence%20of%20linear%20algebra.html">Essence of linear algebra</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Miscellaneous/Early%20managment%20of%20patients%20with%20AIS.html">Early management of patients with acute ischemic stroke</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Miscellaneous/Miscellaneous%20Notes.html">Miscellaneous Study Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Miscellaneous/Phamaceutical%20development.html">Pharmacedutical development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Miscellaneous/Sim-Coin%20flip.html">:bulb: Q: fair coin, # of flips to get two consecutive side (H or T)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Miscellaneous/Sim-Generate%20random%20number%20between%201%20to%207.html">Generate random number 1 to 7 using a fair dice</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/askming/study_notes" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/askming/study_notes/issues/new?title=Issue%20on%20page%20%2FStats/Book-Regression Modeling Strategies.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Stats/Book-Regression Modeling Strategies.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>[book] Regression Modeling Strategies</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-9-overview-of-maximum-likelihood-estimation">Chapter 9 Overview of Maximum Likelihood Estimation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-testing">2. Hypothesis testing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#likelihood-ratio-test">2.1 Likelihood ratio test</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#wald-test">2.2 Wald test</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#score-test">2.3 Score test</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#which-test-to-use-when">Which test to use when</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-case">3. General case</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals">6. Confidence intervals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#further-use-of-the-log-likelihood">8. Further use of the log likelihood</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#weighted-maximum-likelihood-estimation">9. Weighted maximum likelihood estimation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#penalized-maximum-likelihood-estimation">10. Penalized maximum likelihood estimation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-13-ordinal-logistic-regression">Chapter 13 Ordinal Logistic Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#background">1. Background</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ordinality-assumption">2. Ordinality assumption</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proportional-odds-model">3. Proportional odds model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#model">3.1 Model</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-and-interpretation-of-parameters">3.2 Assumptions and interpretation of parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#estimation">3.3 Estimation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#residuals">3.4 Residuals</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#assessment-of-model-fit">3.5 Assessment of model fit</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#quantifying-predictive-ability">3.6 Quantifying predictive ability</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#describing-the-fitted-model">3.7 Describing the fitted model</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#validating-the-fitted-model">3.8 Validating the fitted model</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#r-function">3.9 <code class="docutils literal notranslate"><span class="pre">R</span></code> function</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#continuation-ratio-model">4. Continuation ratio model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">4.1 Model</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-20-cox-proportional-hazards-regression-model">Chapter 20 Cox Proportional Hazards Regression Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">1. Model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#extending-the-ph-cox-model-by-stratification">1.7 Extending the (PH Cox) model by stratification</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-size-considerations">3. Sample size considerations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-statistics">4. Test statistics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">5. Residuals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">6. Assessment of model fit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-to-do-when-ph-fails">7. What to do when PH fails</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="book-regression-modeling-strategies">
<h1>[book] Regression Modeling Strategies<a class="headerlink" href="#book-regression-modeling-strategies" title="Permalink to this heading">#</a></h1>
<hr>
<p><em>A reading note of <span id="id1">Harrell [<a class="reference internal" href="#id7" title="Frank E Harrell. Regression modeling strategies. Bios, 330(2018):14, 2017.">2017</a>]</span></em></p>
<section id="chapter-9-overview-of-maximum-likelihood-estimation">
<h2>Chapter 9 Overview of Maximum Likelihood Estimation<a class="headerlink" href="#chapter-9-overview-of-maximum-likelihood-estimation" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><em>How to understand Fisher information and what info it provides</em>: The degree of peakedness of a function at a given point is the speed with which the slope is changing at that point, that is, the slope of the slope or second derivative of the funciton at that point.</p>
<ul>
<li><p>i.e. at the peak of a function, the speed of slope change is the <em>slowest</em></p></li>
</ul>
</li>
<li><p>An estimate of variance is given by the inverse of the information at the point estimate (e.g. the MLE)</p></li>
</ul>
<section id="hypothesis-testing">
<h3>2. Hypothesis testing<a class="headerlink" href="#hypothesis-testing" title="Permalink to this heading">#</a></h3>
<section id="likelihood-ratio-test">
<h4>2.1 Likelihood ratio test<a class="headerlink" href="#likelihood-ratio-test" title="Permalink to this heading">#</a></h4>
<ul>
<li><p>This test statistic is the ratio of the likelihood at the hypothesized parameter values to the likelihood of the data at the maximum (i.e., at parameter values = MLEs).</p>
<ul class="simple">
<li><p>−2× the log of this likelihood ratio has desirable statistical properties.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[LR = -2\log(L \text{ at } H_0/L \text{ at  MLEs}) \sim \chi^2_p\]</div>
<p>for large enough sample size, where <span class="math notranslate nohighlight">\(p\)</span> is the number parameters to be tested</p>
</li>
</ul>
</section>
<section id="wald-test">
<h4>2.2 Wald test<a class="headerlink" href="#wald-test" title="Permalink to this heading">#</a></h4>
<ul>
<li><p>The Wald test statistic is a generalization of a <em>t-</em> or <em>z-</em> statistic. It is a function of the difference in the MLE and its hypothesized value, normalized by an estimate of the standard deviation of the MLE.  For large enough <span class="math notranslate nohighlight">\(n\)</span>,</p>
<p>​$<span class="math notranslate nohighlight">\(W = \frac{(\hat{\theta} - \theta_0)^2}{var(\hat{\theta})}\sim \chi^2_p\)</span>$</p>
<ul class="simple">
<li><p>Variance of MLE is the inverse of the oberved Fisher information <span class="math notranslate nohighlight">\(1/I(\hat{\theta})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\sqrt{W}\)</span> can follow either <span class="math notranslate nohighlight">\(t\)</span> or normal distribution, depending on if the variance of the estimate is an estimated (like in the normal data) or not (like in the binary data)</p></li>
</ul>
</li>
</ul>
</section>
<section id="score-test">
<h4>2.3 Score test<a class="headerlink" href="#score-test" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>Rao’s score statistic measures how far from zero the score function is when evaluated at the null hypothesis.</p>
<ul>
<li><p>If the MLE happens to equal the hypothesized value <span class="math notranslate nohighlight">\(\theta_0\)</span>, <span class="math notranslate nohighlight">\(\theta_0\)</span> maximizes the likelihood and so <span class="math notranslate nohighlight">\(U(\theta_0) = 0\)</span>.</p></li>
<li><p>The variance of the score function is the Fisher information <span class="math notranslate nohighlight">\(I(\theta_0)\)</span></p></li>
<li><p>Test statistic for score test is defined as <span class="math notranslate nohighlight">\(\frac{U(\theta_0)^2}{I(\theta_0)} \sim \chi^2_p\)</span></p></li>
<li><p>Thus the score test doesn’t invole estimating the MLE</p></li>
</ul>
</li>
</ul>
</section>
<section id="which-test-to-use-when">
<h4>Which test to use when<a class="headerlink" href="#which-test-to-use-when" title="Permalink to this heading">#</a></h4>
<p><img alt="image-20200729230109310" src="https://raw.githubusercontent.com/askming/picgo/master/image-20200729230109310.png?token=ABLIWWZARHQGPM46JKSEN2C7EJRGK" /></p>
</section>
</section>
<section id="general-case">
<h3>3. General case<a class="headerlink" href="#general-case" title="Permalink to this heading">#</a></h3>
<ul>
<li><p>Estimating a vector of parameters</p>
<ul>
<li><p><em>Score vector</em>: first derivative of the log likelihood function w.r.t. all the parameters</p>
<p><span class="math notranslate nohighlight">\(U(B) = (\partial/\partial B)\log L(B)\)</span></p>
</li>
<li><p>Fisher <em>information matrix</em>: a <span class="math notranslate nohighlight">\(p\times p\)</span> matrix whose elements are the negative of the expectation of all second partial derivatives of <span class="math notranslate nohighlight">\(\log L(B)\)</span></p>
<p><span class="math notranslate nohighlight">\(I^*(B) = -E(\partial^2/\partial B\partial B')\log L(B)\)</span></p>
</li>
<li><p>Observed information matrix: is the information matrix without taking expectation</p>
<p><span class="math notranslate nohighlight">\(I(B) = -(\partial^2/\partial B\partial B')\log L(B)\)</span></p>
</li>
</ul>
</li>
<li><p>Global test statistics</p>
<ul class="simple">
<li><p>The extention from one dimentional test to <span class="math notranslate nohighlight">\(p-\)</span>dimensional test</p></li>
</ul>
</li>
<li><p>Testing a subset of the parameters</p></li>
<li><p>Tests based on contrasts</p></li>
</ul>
</section>
<section id="confidence-intervals">
<h3>6. Confidence intervals<a class="headerlink" href="#confidence-intervals" title="Permalink to this heading">#</a></h3>
</section>
<section id="further-use-of-the-log-likelihood">
<h3>8. Further use of the log likelihood<a class="headerlink" href="#further-use-of-the-log-likelihood" title="Permalink to this heading">#</a></h3>
</section>
<section id="weighted-maximum-likelihood-estimation">
<h3>9. Weighted maximum likelihood estimation<a class="headerlink" href="#weighted-maximum-likelihood-estimation" title="Permalink to this heading">#</a></h3>
</section>
<section id="penalized-maximum-likelihood-estimation">
<h3>10. Penalized maximum likelihood estimation<a class="headerlink" href="#penalized-maximum-likelihood-estimation" title="Permalink to this heading">#</a></h3>
</section>
</section>
<section id="chapter-13-ordinal-logistic-regression">
<h2>Chapter 13 Ordinal Logistic Regression<a class="headerlink" href="#chapter-13-ordinal-logistic-regression" title="Permalink to this heading">#</a></h2>
<section id="background">
<h3>1. Background<a class="headerlink" href="#background" title="Permalink to this heading">#</a></h3>
</section>
<section id="ordinality-assumption">
<h3>2. Ordinality assumption<a class="headerlink" href="#ordinality-assumption" title="Permalink to this heading">#</a></h3>
</section>
<section id="proportional-odds-model">
<h3>3. Proportional odds model<a class="headerlink" href="#proportional-odds-model" title="Permalink to this heading">#</a></h3>
<section id="model">
<h4>3.1 Model<a class="headerlink" href="#model" title="Permalink to this heading">#</a></h4>
</section>
<section id="assumptions-and-interpretation-of-parameters">
<h4>3.2 Assumptions and interpretation of parameters<a class="headerlink" href="#assumptions-and-interpretation-of-parameters" title="Permalink to this heading">#</a></h4>
</section>
<section id="estimation">
<h4>3.3 Estimation<a class="headerlink" href="#estimation" title="Permalink to this heading">#</a></h4>
</section>
<section id="residuals">
<h4>3.4 Residuals<a class="headerlink" href="#residuals" title="Permalink to this heading">#</a></h4>
<ul>
<li><p>In binary logistic regression, <em>partial residuals</em> are very useful as they allow the analyst to fit linear effect for all the predictors but then to nonparametrically estimate the true transformation that each predictor requires.</p>
<div class="math notranslate nohighlight">
\[
  r_{im} = \hat{\beta}_mX_{im} + \frac{Y_i - \hat{P}_i}{\hat{P}_i(1-\hat{P}_i)}
  \]</div>
<p>​	where</p>
<div class="math notranslate nohighlight">
\[
  \hat{P}_i= \frac{1}{1 +\exp[-(\alpha + X_i\hat{\beta})]}
  \]</div>
<ul class="simple">
<li><p>A smoothed plot (e.g., using the moving linear regression algorithm in
<code class="docutils literal notranslate"><span class="pre">loess</span></code>) of <span class="math notranslate nohighlight">\(X_{im}\)</span> against <span class="math notranslate nohighlight">\(r_{im}\)</span> provides a nonparametric estimation of how <span class="math notranslate nohighlight">\(X_m\)</span> relates to the log relative odds that <span class="math notranslate nohighlight">\(Y = 1 | X_{m}\)</span>.</p></li>
<li><p>Since partial residuals allow examination of predictor transformations (linearity) while simultaneously allowing examination of PO (parallelism), partial residual plots are generally preferred over score residual plots for ordinal models.</p></li>
</ul>
</li>
</ul>
</section>
<section id="assessment-of-model-fit">
<h4>3.5 Assessment of model fit<a class="headerlink" href="#assessment-of-model-fit" title="Permalink to this heading">#</a></h4>
<ul>
<li><p>Score test in <code class="docutils literal notranslate"><span class="pre">PROC</span> <span class="pre">LOGISTIC</span></code>: extreme anti-conservatism in many cases</p></li>
<li><p>Compare means of <span class="math notranslate nohighlight">\(X|Y\)</span> with and without assuming PO</p></li>
<li><p>Stratifying one each predictor and computing the logits of all proportions of the form <span class="math notranslate nohighlight">\(Y\ge j, j = \text{1, 2, }\cdots, k\)</span>. When proportional odds holds, the difference in logits between different values of <span class="math notranslate nohighlight">\(j\)</span> should be the same at all levels of <span class="math notranslate nohighlight">\(X\)</span>, because the model dictates that <span class="math notranslate nohighlight">\(logit(Y\ge j| X) - logit(Y\ge i|X) = \alpha_j - \alpha_i\)</span>, for any constant <span class="math notranslate nohighlight">\(X\)</span>.</p>
<ul>
<li><p>We check both the consistency of <span class="math notranslate nohighlight">\(logit(Y\ge j| X) - logit(Y\ge i|X)\)</span> at different <span class="math notranslate nohighlight">\(X\)</span> levels</p></li>
<li><p>Or we can check the parallelism of <span class="math notranslate nohighlight">\(logit(Y\ge j| X) - logit(Y\ge j|X+k)\)</span> for <span class="math notranslate nohighlight">\(Y = 1, \cdots, J\)</span> (right below)</p>
<p><img alt="image-20200828135732415" src="https://raw.githubusercontent.com/askming/picgo/master/image-20200828135732415.png" /></p>
</li>
</ul>
</li>
<li><p>Regarding assessment of linearity and additivity assumptions, splines, partial residual plots, and interaction tests are among the best tools.</p></li>
</ul>
</section>
<section id="quantifying-predictive-ability">
<h4>3.6 Quantifying predictive ability<a class="headerlink" href="#quantifying-predictive-ability" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R_N^2\)</span> coefficient: model LR <span class="math notranslate nohighlight">\(\chi^2\)</span> (<span class="math notranslate nohighlight">\(\chi^2\)</span> added to a model containing only the <span class="math notranslate nohighlight">\(k\)</span> intercept parameter)</p></li>
<li><p>Somers’ <span class="math notranslate nohighlight">\(D_{xy}\)</span> rank correlation between <span class="math notranslate nohighlight">\(X\hat{\beta}\)</span> and <span class="math notranslate nohighlight">\(Y\)</span></p></li>
<li><p>Probability of concordance <span class="math notranslate nohighlight">\(c\)</span> (a generalized ROC area): the fraction of pairs for which the values of <span class="math notranslate nohighlight">\(X\hat{\beta}\)</span> are in the same direction among all possible pairs of subjects having different <span class="math notranslate nohighlight">\(Y\)</span> values</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(D_{xy} = 2(c - 0.5)\)</span></p></li>
</ul>
</li>
</ul>
</section>
<section id="describing-the-fitted-model">
<h4>3.7 Describing the fitted model<a class="headerlink" href="#describing-the-fitted-model" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(logit(Y\ge j|X)\)</span>, the linear predictor</p></li>
<li><p><span class="math notranslate nohighlight">\(Prob(Y\ge j| X)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(Prob(Y=j|X)\)</span></p></li>
<li><p>Quantiles of <span class="math notranslate nohighlight">\(Y|X\)</span>, e.g. the median</p></li>
<li><p><span class="math notranslate nohighlight">\(E(Y|X)\)</span> if <span class="math notranslate nohighlight">\(Y\)</span> is interval scaled</p></li>
</ul>
</section>
<section id="validating-the-fitted-model">
<h4>3.8 Validating the fitted model<a class="headerlink" href="#validating-the-fitted-model" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>The PO model is validated much the same way as the binary logistic model</p></li>
<li><p>For estimating an overfitting-corrected calibration curve one estimates <span class="math notranslate nohighlight">\(Pr(Y ≥ j|X)\)</span> using one <span class="math notranslate nohighlight">\(j\)</span> at a time.</p></li>
</ul>
</section>
<section id="r-function">
<h4>3.9 <code class="docutils literal notranslate"><span class="pre">R</span></code> function<a class="headerlink" href="#r-function" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{rms}</span></code>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">rms::lrm</span></code> : intended to be used for the cases where the number of unique values of <span class="math notranslate nohighlight">\(Y\)</span> are less than a few doze</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rms::orm</span></code>: handles the continuous Y case efficiently and allows for links other than the logit</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">{Hmisc}</span></code>: <code class="docutils literal notranslate"><span class="pre">popower</span></code> and <code class="docutils literal notranslate"><span class="pre">posamsize</span></code> compute power and sample size estimates for ordinal responses using the proportional odds model.</p></li>
</ul>
</section>
</section>
<section id="continuation-ratio-model">
<h3>4. Continuation ratio model<a class="headerlink" href="#continuation-ratio-model" title="Permalink to this heading">#</a></h3>
<section id="id2">
<h4>4.1 Model<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h4>
<ul>
<li><p>The continuation ratio (CR) model is based on conditional probabilities. The (forward) CR model is defined as follows:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d6651c93-c4dd-46db-97f5-19c263016f7f">
<span class="eqno">(10)<a class="headerlink" href="#equation-d6651c93-c4dd-46db-97f5-19c263016f7f" title="Permalink to this equation">#</a></span>\[\begin{align}
   P(Y=j|Y\ge j,  X) &amp; = \frac{1}{1+\exp[-(\theta_j + X\gamma)]}\\
   logit(Y=0|Y\ge0, X) &amp; = logit(Y=0|X)\\
   &amp;=\theta_0 + X\gamma\\
   
   logit(Y = k-1|Y \ge k-1, X) &amp; = \theta_{k-1} + X\gamma
  \end{align}\]</div>
<ul class="simple">
<li><p>the CR model has been said to be likely to fit ordinal responses when subjects have to “pass through” one category to get to the next.</p></li>
<li><p>It is a <strong>discrete version of the Cox PH model</strong>, the discrete hazard function is defined as <span class="math notranslate nohighlight">\(P(Y=j|Y\ge j)\)</span>.</p></li>
</ul>
</li>
</ul>
</section>
</section>
</section>
<section id="chapter-20-cox-proportional-hazards-regression-model">
<h2>Chapter 20 Cox Proportional Hazards Regression Model<a class="headerlink" href="#chapter-20-cox-proportional-hazards-regression-model" title="Permalink to this heading">#</a></h2>
<section id="id3">
<h3>1. Model<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<section id="extending-the-ph-cox-model-by-stratification">
<h4>1.7 Extending the (PH Cox) model by stratification<a class="headerlink" href="#extending-the-ph-cox-model-by-stratification" title="Permalink to this heading">#</a></h4>
<ul>
<li><p>The model assumes different baseline hazard but common regression coefficient among stratified models</p>
<p><span class="math notranslate nohighlight">\(\lambda(t | C =j) = \lambda_j(t)\exp(X\beta)\)</span></p>
<ul class="simple">
<li><p>The idea is to allow the form of the underlying hazard function to vary across levels of the stratification factors</p></li>
</ul>
</li>
<li><p>In most cases the loss of efficiency by stratification is small as long as the number of strata is not too large with regard to the total number of events.</p>
<ul class="simple">
<li><p>A stratum that contains no events contributes no information to the analysis, so such a situation should be avoided if possible.</p></li>
</ul>
</li>
<li><p>If different strata are made up of independent subjects, the strata are independent and the likelihood functions are multiplied together to form a joint likelihood over strata. Log likelihood functions are thus added over strata.</p>
<ul class="simple">
<li><p>No inference can be made about the stratification factors. They are merely “adjusted
for.”</p></li>
</ul>
</li>
<li><p>Stratification is useful for checking the <strong>PH</strong> and <strong>linearity</strong> assumptions for one or more predictors.</p>
<ul class="simple">
<li><p>Predicted Cox survival curves can be derived by modeling the predictors in the usual way, and then stratified survival curves can be estimated by using those predictors as stratification factors.</p></li>
<li><p>Other factors for which PH is assumed can be modeled in both instances.</p></li>
<li><p>By comparing the modeled versus stratified survival estimates, a graphical check of the assumptions can be made.</p></li>
</ul>
</li>
<li><p>Besides allowing a factor to be adjusted for without modeling its effect a stratified Cox PH model can also allow a modeled factor to interact with strata:</p>
<p><span class="math notranslate nohighlight">\(\lambda(t|X_1, C=j) = \lambda_j(t)\exp(\beta_1X_1 + \beta_2X_2)\)</span> for <span class="math notranslate nohighlight">\(j = 1, 2\)</span> (example)</p>
<p>where <span class="math notranslate nohighlight">\(X_2 = 0\)</span> for <span class="math notranslate nohighlight">\(j = 1\)</span> and <span class="math notranslate nohighlight">\(X_1\)</span> for <span class="math notranslate nohighlight">\(j=2\)</span></p>
</li>
<li><p>The stratified Cox model turns out to be a generalization of the <strong>conditional logistic model</strong> for analyzing matched set (e.g., case-control) data. (??)</p>
<ul class="simple">
<li><p>Each stratum represents a set, and the number of “failures” in the set is the number of “cases” in that set.</p></li>
<li><p>For <span class="math notranslate nohighlight">\(r : 1\)</span> matching (<span class="math notranslate nohighlight">\(r\)</span> may vary across sets), the Breslow likelihood may be used to fit the conditional logistic model exactly. For <span class="math notranslate nohighlight">\(r : m\)</span> matching, an exact Cox likelihood must be computed.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="sample-size-considerations">
<h3>3. Sample size considerations<a class="headerlink" href="#sample-size-considerations" title="Permalink to this heading">#</a></h3>
<ul>
<li><p>Then the Kaplan-Meier estimate (<em>one-sample</em>) is just one minus the empirical cumulative distribution function, assuming there is no censoring. By the <em>Dvoretzky-Kiefer-Wolfowitz inequality</em>, the maximum absolute error in an empirical distribution function estimate of the true continuous distribution function is less than or equal to <span class="math notranslate nohighlight">\(\epsilon\)</span> with probability of at least <span class="math notranslate nohighlight">\(1 − 2e^{−2n\epsilon^2}\)</span>.</p></li>
<li><p>To estimate the subject-specific survival curves <span class="math notranslate nohighlight">\((S(t|X))\)</span> will require greater sample sizes, as will having censored data.</p></li>
<li><p>To estimate hazard ratio:</p>
<ul>
<li><p>if the total sample size is <span class="math notranslate nohighlight">\(n\)</span> and the number of events in the two categories are respectively <span class="math notranslate nohighlight">\(e_0\)</span> and <span class="math notranslate nohighlight">\(e_1\)</span>, the variance of the log hazard ratio is approximately <span class="math notranslate nohighlight">\(v = \frac{1}{e_0} + \frac{1}{e_1}\)</span></p></li>
<li><p>Letting <span class="math notranslate nohighlight">\(z\)</span> denote the <span class="math notranslate nohighlight">\(1 − \alpha/2\)</span> standard normal critical value, the multiplicative margin</p>
<p>of error (MMOE) with confidence <span class="math notranslate nohighlight">\(1 − \alpha\)</span> is given by <span class="math notranslate nohighlight">\(\exp(z\sqrt{v})\)</span>.</p>
</li>
</ul>
</li>
</ul>
</section>
<section id="test-statistics">
<h3>4. Test statistics<a class="headerlink" href="#test-statistics" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Wald, score, and likelihood ratio statistics are useful and valid for drawing inferences about β in the Cox model.</p>
<ul>
<li><p>If there is a single binary predictor in the model that describes two groups, the score test for assessing the importance of the binary predictor is virtually identical to the Mantel–Haenszel log-rank test for comparing the two groups.</p></li>
<li><p>If the analysis is stratified for other (<strong>nonmodeled</strong>) factors, the score test from a stratified Cox model is equivalent to the corresponding stratified log-rank test.</p></li>
</ul>
</li>
<li><p>The likelihood ratio or Wald tests could also be used in this situation, and in fact the likelihood ratio test may be better than the score test (i.e., type I errors by treating the likelihood ratio test statistic as having a <span class="math notranslate nohighlight">\(\chi^2\)</span> distribution may be more accurate than using the log-rank statistic).</p></li>
<li><p>The Cox model can be thought of as a generalization of the log-rank procedure since it allows one to test continuous predictors, perform simultaneous tests of various predictors, and adjust for other continuous factors without grouping them. Although a stratified log-rank test does not make assumptions regarding the effect of the adjustment (stratifying) factors, it makes the same assumption (i.e., PH) as the Cox model regarding the treatment effect for the statistical test of no difference in survival between groups.</p></li>
</ul>
</section>
<section id="id4">
<h3>5. Residuals<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<ul>
<li><p><em>Therneau et al.</em> discussed four types of residuals from the Cox model**: martingale, score, Schoenfeld**, and <strong>deviance</strong>.</p>
<p><img alt="image-20200807104402567" src="https://raw.githubusercontent.com/askming/picgo/master/image-20200807104402567.png" /></p>
</li>
</ul>
</section>
<section id="id5">
<h3>6. Assessment of model fit<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
</section>
<section id="what-to-do-when-ph-fails">
<h3>7. What to do when PH fails<a class="headerlink" href="#what-to-do-when-ph-fails" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Also check note on <a class="reference internal" href="Note-Cox_PH_model.html"><span class="doc std std-doc">Cox PH Model</span></a></p></li>
</ul>
<div class="docutils container" id="id6">
<div class="citation" id="id7" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">Har17</a><span class="fn-bracket">]</span></span>
<p>Frank E Harrell. Regression modeling strategies. <em>Bios</em>, 330(2018):14, 2017.</p>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Stats"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>
    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Book-Group%20Sequential%20and%20Confirmatory%20Adaptive%20Designs%20in%20Clinical%20Trials.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">[book] Group Sequential and Confirmatory Adaptive Designs in Clinical Trials</p>
      </div>
    </a>
    <a class="right-next"
       href="Note-Adaptive%20Trial%20Design.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Adaptive Clinical Trial Design</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-9-overview-of-maximum-likelihood-estimation">Chapter 9 Overview of Maximum Likelihood Estimation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-testing">2. Hypothesis testing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#likelihood-ratio-test">2.1 Likelihood ratio test</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#wald-test">2.2 Wald test</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#score-test">2.3 Score test</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#which-test-to-use-when">Which test to use when</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-case">3. General case</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals">6. Confidence intervals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#further-use-of-the-log-likelihood">8. Further use of the log likelihood</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#weighted-maximum-likelihood-estimation">9. Weighted maximum likelihood estimation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#penalized-maximum-likelihood-estimation">10. Penalized maximum likelihood estimation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-13-ordinal-logistic-regression">Chapter 13 Ordinal Logistic Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#background">1. Background</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ordinality-assumption">2. Ordinality assumption</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proportional-odds-model">3. Proportional odds model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#model">3.1 Model</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-and-interpretation-of-parameters">3.2 Assumptions and interpretation of parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#estimation">3.3 Estimation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#residuals">3.4 Residuals</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#assessment-of-model-fit">3.5 Assessment of model fit</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#quantifying-predictive-ability">3.6 Quantifying predictive ability</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#describing-the-fitted-model">3.7 Describing the fitted model</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#validating-the-fitted-model">3.8 Validating the fitted model</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#r-function">3.9 <code class="docutils literal notranslate"><span class="pre">R</span></code> function</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#continuation-ratio-model">4. Continuation ratio model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">4.1 Model</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-20-cox-proportional-hazards-regression-model">Chapter 20 Cox Proportional Hazards Regression Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">1. Model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#extending-the-ph-cox-model-by-stratification">1.7 Extending the (PH Cox) model by stratification</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-size-considerations">3. Sample size considerations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-statistics">4. Test statistics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">5. Residuals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">6. Assessment of model fit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-to-do-when-ph-fails">7. What to do when PH fails</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ming Yang
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>