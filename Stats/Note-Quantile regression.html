
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Quantile regression &#8212; Study Notes</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script src="https://wavedrom.com/skins/default.js"></script>
    <script src="https://wavedrom.com/wavedrom.min.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sample size calculation for the Wilcoxon-Mann-Whitney test adjusting for ties" href="Note-Sample_size_calculation_with_WMW_test.html" />
    <link rel="prev" title="Propensity Score Methods &amp; Implementation" href="Note-Propensity%20score%20methods.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Study Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Study Notes Index (knowledge base structure)
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statistics
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Book-Analysis%20of%20Observational%20Health%20Care%20Data%20Using%20SAS.html">
   [book] Analysis of Observational Health Care Data Using SAS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Book-Causal_inference_in_statistics_a_primer.html">
   [book] Causal inference in statistics
   <em>
    a primer
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Book-Data_Analysis_Using_Regression_and_Multilevel_Hierarchical_Models.html">
   [book] Data Analysis Using Regression and Multilevel/Hierarchical Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Book-Fundamentals%20of%20Clinical%20Trials%20%284th%20edition%29.html">
   [book] Fundamentals of Clinical Trials (4th edition)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Book-Group%20Sequential%20and%20Confirmatory%20Adaptive%20Designs%20in%20Clinical%20Trials.html">
   [book] Group Sequential and Confirmatory Adaptive Designs in Clinical Trials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Book-Regression%20Modeling%20Strategies.html">
   [book] Regression Modeling Strategies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Adaptive%20Trial%20Design.html">
   Adaptive Clinical Trial Design
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Analysis%20of%20Ordinal%20Outcome.html">
   Analysis of ordinal outcome
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Analysis%20of%20Stratified%20Randomization%20Trial%20Data.html">
   Why analysis of stratified randomization trial data need to account for the stratification factors?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Association%20vs.%20Prediction%20vs.%20Causation.html">
   Association vs. Prediction vs. Causation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Baseline%20Adaptive%20Randomization.html">
   Baseline adaptive randomization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Bayesian%20optimization.html">
   Exploring Bayesian Optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Causal%20inference%20general.html">
   Causal Inference General Study Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Competing_Risk_Regression.html">
   Competing risk models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Correlated%20Data%20Analysis.html">
   Correlated/Longitudinal Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Cox_PH_model.html">
   ​Cox PH model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Dirichlet%20process.html">
   Dirichlet process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-FDA%20guidances%20for%20industry.html">
   Notes on FDA Guidances for Industry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Gaussian%20process.html">
   Gaussain Process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Group_Sequential_Trial_Design.html">
   Notes on Group Sequential Trial Design​
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-ICH%20guidelines.html">
   Notes on ICH guidelines​
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-MDD%20%26%20Effect%20size.html">
   Power,
   <strong>
    MDD
   </strong>
   /
   <strong>
    E
   </strong>
   (minimum detectable difference/effect), and
   <strong>
    Effect size
   </strong>
   in clinical trials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Meta-Analysis.html">
   Meta-analysis​
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Missing%20data.html">
   Missing data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Model%20comparison%20methods.html">
   Model comparison methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Monte%20Carlo%20method.html">
   Monte Carlo Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Multicolinearity.html">
   Multicolinearity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Multiplicity%20in%20Clinical%20Trials.html">
   Multiplicity in Clinical Trials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Non-inferiority%20equivalence%20superiority%20test.html">
   Non-inferiority/equivalence/superiority test basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Observational%20study%20design.html">
   Observational study design
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Propensity%20score%20methods.html">
   Propensity Score Methods &amp; Implementation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Quantile regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Sample_size_calculation_with_WMW_test.html">
   Sample size calculation for the Wilcoxon-Mann-Whitney test adjusting for ties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Note-Survival_Analysis.html">
   Survival Analysis
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statistical computing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Stats_Comp/Note-How%20R%20searches%20and%20finds%20stuff.html">
   How R searches and finds stuff
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Stats_Comp/Note-R%20notes.html">
   R study notes/tips
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Stats_Comp/Note-googleVis.html">
   Google R package googleVis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Stats_Comp/Note-matplotlib.html">
   Notes on
   <code class="docutils literal notranslate">
    <span class="pre">
     matplotlib
    </span>
   </code>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  DS/ML
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Book-Hands-On%20Machine%20Learning%20with%20Scikit-Learn%20and%20TensorFlow.html">
   [book] Hands-On Machine Learning with Scikit-Learn and TensorFlow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Book-Python%20Data%20Science%20Handbook.html">
   [book] Python Data Science Handbook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Course-Udemy-%20Python%20for%20Data%20Science%20and%20Machine%20Learning%20Bootcamp.html">
   Udemy: Python for Data Science and Machine Learning Bootcamp
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Note-Boosting.html">
   Boosting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Note-Cluster%20analysis.html">
   Cluster analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Note-Machine%20Learning%20%28General%29.html">
   ​Machine Learning (General)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Note-Naive%20Bayes.html">
   Naive Bayes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Note-Stochasitic%20Gradient%20Descent.html">
   Stochastic Gradient Decent (SGD)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DS_ML/Note-Tree%2C%20Random%20Forest%20%28Bagging%29.html">
   Tree/Random Forest (Bagging)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Computer science
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Course-%E5%BB%96%E9%9B%AA%E5%B3%B0python%E6%95%99%E7%A8%8B%E7%AC%94%E8%AE%B0.html">
   廖雪峰python教程笔记
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Note-HTML%20basics.html">
   HTML Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Note-Hard%20SQL%20interview%20questions.html">
   Hard Data Analyst SQL Interview Questions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Note-Inside%20look%20at%20modern%20web%20browser.html">
   Inside look at modern web browser
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Note-Learning%20React.html">
   Learning React
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Note-Learning%20Rust.html">
   Learning Rust
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Note-Modern%20JS%20explained.html">
   Modern JavaScript Explained
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Note-SQL%20Study%20Notes.html">
   SQL study notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CS/Note-git%20and%20github.html">
   git and github
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Math
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Math/Course-Essence%20of%20linear%20algebra.html">
   Essence of linear algebra
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Miscellaneous
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Miscellaneous/Early%20managment%20of%20patients%20with%20AIS.html">
   Early management of patients with acute ischemic stroke
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Miscellaneous/Miscellaneous%20Notes.html">
   Miscellaneous Study Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Miscellaneous/Phamaceutical%20development.html">
   Pharmacedutical development
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Miscellaneous/Sim-Coin%20flip.html">
   :bulb: Q: fair coin, # of flips to get two consecutive side (H or T)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Miscellaneous/Sim-Generate%20random%20number%20between%201%20to%207.html">
   Generate random number 1 to 7 using a fair dice
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/askming/study_notes"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/askming/study_notes/issues/new?title=Issue%20on%20page%20%2FStats/Note-Quantile regression.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Stats/Note-Quantile regression.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#advantages-and-applications">
   1. Advantages and applications
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quantiles">
   2. Quantiles
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#intuition">
   3. Intuition
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conditional-quantile-and-quantile-regression">
   4. Conditional quantile and quantile regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bayesian-quantile-regression">
   5. Bayesian quantile regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#censored-quantile-regression">
   6. Censored quantile regression
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Quantile regression</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#advantages-and-applications">
   1. Advantages and applications
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quantiles">
   2. Quantiles
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#intuition">
   3. Intuition
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conditional-quantile-and-quantile-regression">
   4. Conditional quantile and quantile regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bayesian-quantile-regression">
   5. Bayesian quantile regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#censored-quantile-regression">
   6. Censored quantile regression
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="quantile-regression">
<h1>Quantile regression<a class="headerlink" href="#quantile-regression" title="Permalink to this headline">#</a></h1>
<p><strong>Quantile regression</strong> is a type of regression analysis aims at estimating either the conditional median or other quantiles of the response variable, whereas the method of least squares results in estimates that approximate the conditional mean of the response variable given certain values of the predictor variables.</p>
<section id="advantages-and-applications">
<h2>1. Advantages and applications<a class="headerlink" href="#advantages-and-applications" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Quantile regression is desired if conditional quantile functions are of interest.</p></li>
<li><p>One advantage of quantile regression, relative to the ordinary least squares regression, is that the quantile regression estimates are more robust against outliers in the response measurements.</p></li>
<li><p>In practice we often prefer using different measures of central tendency and statistical dispersion to obtain a more comprehensive analysis of the relationship between variables.</p></li>
<li><p>The need for and success of quantile regression in ecology has been attributed to the complexity of interactions between different factors leading to data with unequal variation of one variable for different ranges of another variable.</p></li>
<li><p>The method of least squares leads to a consideration of problems in an inner product space, involving projection onto subspaces, and thus the problem of minimizing the squared errors can be reduced to a problem in numerical linear algebra. Quantile regression does not have this structure,  and instead leads to problems in <em>linear programming</em> that can be solved by the simplex method.</p></li>
</ul>
</section>
<section id="quantiles">
<h2>2. Quantiles<a class="headerlink" href="#quantiles" title="Permalink to this headline">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(Y\)</span> be real valued random variable with cumulative distribution function <span class="math notranslate nohighlight">\(F_Y(y) = P(Y\le y)\)</span>. The <span class="math notranslate nohighlight">\(\tau\)</span>th quantile of <span class="math notranslate nohighlight">\(Y\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[
Q_Y(\tau) = F^{-1}_Y(\tau) = \inf\{y: F_Y(y)\ge \tau\}
\]</div>
<p>Where <span class="math notranslate nohighlight">\(\tau \in [0, 1]\)</span>.</p>
<ul>
<li><p><strong>Loss function</strong></p>
<p>Define the loss function as <span class="math notranslate nohighlight">\(\rho_{\tau}(y) = |y(\tau - \mathbb{I}_{y&lt;0})|\)</span>, where <span class="math notranslate nohighlight">\(\mathbb{I}\)</span> is an indicator variable. A specific quantile can be found by minimizing the expected loss of <span class="math notranslate nohighlight">\(Y − u\)</span> with respect to <span class="math notranslate nohighlight">\(u\)</span>:</p>
<div class="math notranslate nohighlight">
\[
  \min_{u}E(\rho_{\tau}(Y-u)) = \min_{u}(\tau - 1)\int_{-\infty}^u(y-u)dF_Y(y) + \tau\int_u^{\infty}(y-u)dF_Y(y).
  \]</div>
<p>This can be shown by setting the derivative of the expected loss function to 0 and letting <span class="math notranslate nohighlight">\(q_{\tau}\)</span> be the solution of</p>
<div class="math notranslate nohighlight">
\[
  0 = (1-\tau)\int_{-\infty}^{q_{\tau}}dF_Y(y) - \tau\int_{q_{\tau}}^{\infty}dF_Y(y).
  \]</div>
<p>This equation reduces to</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  0 = F_Y(q_{\tau}) - \tau,\\
  F_Y(q_{\tau}) = \tau.
  \end{split}\]</div>
</li>
</ul>
</section>
<section id="intuition">
<h2>3. Intuition<a class="headerlink" href="#intuition" title="Permalink to this headline">#</a></h2>
<p>Consider <span class="math notranslate nohighlight">\(\tau = 0.5\)</span> and let <span class="math notranslate nohighlight">\(q\)</span> be an initial guess for <span class="math notranslate nohighlight">\(q_{\tau}\)</span>. The expected loss evaluated at <span class="math notranslate nohighlight">\(q\)</span> is</p>
<div class="math notranslate nohighlight">
\[
-0.5\int_{-\infty}^q(y-q)dF_Y(y) + 0.5\int_q^{\infty}(y-q)dF_Y(y).
\]</div>
<p>In order to minimize the expected loss, we move the value of <span class="math notranslate nohighlight">\(q\)</span> a little bit to see whether the expect loss will rise or fall.</p>
<p>Suppose we increase <span class="math notranslate nohighlight">\(q\)</span> by 1 unit. Then the change of expected loss would be</p>
<div class="math notranslate nohighlight">
\[
\int_{-\infty}^q1dF_Y(y) + 0.5\int_q^{\infty}1dF_Y(y).
\]</div>
<p>The first term of the equation is <span class="math notranslate nohighlight">\(F_Y (q)\)</span> and second term of the equation is <span class="math notranslate nohighlight">\(1-F_Y(q)\)</span>. Therefore the change of expected loss function is negative if and only if <span class="math notranslate nohighlight">\(F_Y (q)&lt;0.5\)</span>, that is if and only if <span class="math notranslate nohighlight">\(q\)</span> is smaller than the median. Similarly, if we reduce <span class="math notranslate nohighlight">\(q\)</span> by 1 unit, the change of expected loss function is negative if and only if <span class="math notranslate nohighlight">\(q\)</span> is larger than the median.</p>
<ul class="simple">
<li><p>In order to minimize the expected loss function, we would increase (decrease) <span class="math notranslate nohighlight">\(L(q)\)</span> if q is smaller (larger) than the median, until q reaches the median. The idea behind the minimization is to count the number of points (weighted with the density) that are larger or smaller than <span class="math notranslate nohighlight">\(q\)</span> and then move <span class="math notranslate nohighlight">\(q\)</span> to a point where <span class="math notranslate nohighlight">\(q\)</span> is larger than <span class="math notranslate nohighlight">\(\tau\)</span>% of the points.</p></li>
</ul>
</section>
<section id="conditional-quantile-and-quantile-regression">
<h2>4. Conditional quantile and quantile regression<a class="headerlink" href="#conditional-quantile-and-quantile-regression" title="Permalink to this headline">#</a></h2>
<p>Suppose the <span class="math notranslate nohighlight">\(\tau\)</span>th conditional quantile function is <span class="math notranslate nohighlight">\(Q_{Y|X}(\tau)=X\beta_{\tau}\)</span>, given tghe distribution function of <span class="math notranslate nohighlight">\(Y\)</span>, <span class="math notranslate nohighlight">\(\beta_{\tau}\)</span>can be obtained by solving</p>
<div class="math notranslate nohighlight">
\[
\beta_{\tau} = \arg\min_{\beta\in R^{k}}E(\rho_{\tau}(Y-X\beta)).
\]</div>
<p>Solving the sample analog gives the estimator of <span class="math notranslate nohighlight">\(\beta\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\hat{\beta}_{\tau} = \arg\min_{\beta\in R^k}\sum_{i=1}^n(\rho_{\tau}(Y_i-X_i\beta)).
\]</div>
<ul>
<li><p><strong>Computation</strong></p>
<ul>
<li><p>The minimization problem can be reformulated as a <em>linear programming</em> problem</p>
<div class="math notranslate nohighlight">
\[
    \min_{\beta^+, \beta^-, u^-\in R^{2k}\times R_+^{2n}}\left\{\tau I'_nu^+ + (1-\tau)I'_n u^-|X(\beta^+-\beta^-)+u^+-u^- = Y \right\},
    \]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[
    \beta_j^+ =\max(\beta_j, 0), \beta^-_j = -\min(\beta_j, 0), u_j^+=\max(u_j, 0), u_j^- = -\min(u_j, 0).
    \]</div>
</li>
<li><p><em>Simplex methods or interior point methods</em> can be applied to solve the linear programming problem.</p></li>
</ul>
</li>
<li><p><strong>Asymptotic properties</strong></p>
<ul class="simple">
<li><p>For <span class="math notranslate nohighlight">\(\tau\in(0, 1)\)</span>, under some regularity conditions, <span class="math notranslate nohighlight">\(\hat{\beta}_{\tau}\)</span> is asymptotically normal:
$<span class="math notranslate nohighlight">\(
\sqrt{n}(\hat{\beta}_{\tau}-\beta_{\tau}) \overset{d}{\rightarrow} N(0, \tau(1-\tau)D^{-1}\Omega_xD^{-1})
\)</span>$</p></li>
<li><p>Direct estimation of the asymptotic variance-covariance matrix is not always satisfactory. Inference for quantile regression parameters can be made with the <em>regression rank-score tests</em> or with the <em>bootstrap</em> methods.</p></li>
</ul>
</li>
</ul>
</section>
<section id="bayesian-quantile-regression">
<h2>5. Bayesian quantile regression<a class="headerlink" href="#bayesian-quantile-regression" title="Permalink to this headline">#</a></h2>
<ul>
<li><p>Because the quantile regression does not normally assume a parametric likelihood for the conditional distributions of <span class="math notranslate nohighlight">\(Y|X\)</span>, the Bayesian methods work with a working likelihood.</p></li>
<li><p>A convenient choice is the <em><strong>asymmetric Laplacian distribution</strong></em>, because the mode of the resulting posterior under a flat prior is the usual quantile regression estimates.<span id="id1">[<a class="reference internal" href="#id25" title="Roger Koenker and Gilbert Bassett Jr. Regression quantiles. Econometrica: journal of the Econometric Society, pages 33–50, 1978.">Koenker and Bassett Jr, 1978</a>]</span></p>
<ul>
<li><p><strong>Asymmetric Laplace distribution (ALD)</strong>, density function is given by:</p>
<div class="math notranslate nohighlight">
\[
    f_p(u)=p(1-p)\exp\{-\rho_p(u)\},
    \]</div>
<p>where <span class="math notranslate nohighlight">\(0 &lt; p &lt; 1\)</span> and <span class="math notranslate nohighlight">\(\rho_p(u)=u(p-I(u&lt;0))\)</span>.</p>
<ul>
<li><p>When <span class="math notranslate nohighlight">\(p=1/2\)</span>, the density reduces to</p>
<div class="math notranslate nohighlight">
\[
       f(u)=\frac{1}{4}\exp(-|u|/2),
       \]</div>
<p>which is the density of a <strong>standard symmetric Laplace distribuiton.</strong></p>
</li>
<li><p>For all other values of <span class="math notranslate nohighlight">\(p\)</span>, the density is asymmetic.</p></li>
</ul>
</li>
<li><p>Including location and scale parameters, <span class="math notranslate nohighlight">\(\mu, \sigma\)</span>, in the ALD we obtain</p>
<div class="math notranslate nohighlight">
\[
    f_p(u;\mu,\sigma)=\frac{p(1-p)}{\sigma}\exp\left\{-\rho_p\left(\frac{u-\mu}{\sigma}\right)\right\}.
    \]</div>
</li>
</ul>
</li>
<li><p><em><strong>Bayesian quantile regression inference</strong></em></p>
<p>When we are interested in the conditional quantile, <span class="math notranslate nohighlight">\(q_p(y_i|{\bf x_i})\)</span>, rather than the conditonal mean, <span class="math notranslate nohighlight">\(E[Y_i|x_i]\)</span>, we could still cast the problem in the framework of the generalized linear model, no matter what the original distribution of the data is, by assuming that</p>
<p>​	(i) <span class="math notranslate nohighlight">\(f(y;\mu_i)\)</span> is ALD and</p>
<p>​	(ii) <span class="math notranslate nohighlight">\(g(\mu_i)={\bf x_i}'\boldsymbol{\beta}(p)=q_p(y_i|{\bf x_i})\)</span>, for any <span class="math notranslate nohighlight">\(0 &lt; p &lt; 1\)</span>.</p>
<ul>
<li><p>Given the observations, <span class="math notranslate nohighlight">\({\bf y}=(y_1,\cdots,y_n)\)</span>, the posterior distribution of <span class="math notranslate nohighlight">\(\boldsymbol{\beta}, \pi(\boldsymbol{\beta}|{\bf y})\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[
    \pi(\boldsymbol{\beta}|{\bf y})\propto L({\bf y}|\boldsymbol{\beta})p(\boldsymbol{\beta})
    \]</div>
<p>where <span class="math notranslate nohighlight">\(p(\boldsymbol{\beta})\)</span> is the prior distribution of <span class="math notranslate nohighlight">\(\boldsymbol{\beta}\)</span> and <span class="math notranslate nohighlight">\(L({\bf y}|\boldsymbol{\beta})\)</span> is the likelihood function written as</p>
<div class="math notranslate nohighlight">
\[
    L({\bf y}|\boldsymbol{\beta})=p^n(1-p)^n\exp\left\{-\sum_{i}\rho_p(y_i-{\bf x_i}'\boldsymbol{\beta})\right\},
    \]</div>
<p>with a location parameter <span class="math notranslate nohighlight">\(\mu_i={\bf x_i}'\boldsymbol{\beta}.\)</span></p>
</li>
<li><p>In theory, we can use any prior for <span class="math notranslate nohighlight">\(\boldsymbol{\beta}\)</span>, but in the absence of any realistic information one could use improper uniform prior distribution for all the components of <span class="math notranslate nohighlight">\(\boldsymbol{\beta}\)</span>.</p></li>
</ul>
</li>
<li><p>The posterior inference, however, must be interpreted with care. <span id="id2">[<a class="reference internal" href="#id24" title="Yunwen Yang and Xuming He. Bayesian empirical likelihood for quantile regression. The Annals of Statistics, 40(2):1102–1131, 2012.">Yang and He, 2012</a>]</span> showed that one can have asymptotically valid posterior inference if the working likelihood is chosen to be the empirical likelihood.</p></li>
</ul>
</section>
<section id="censored-quantile-regression">
<h2>6. Censored quantile regression<a class="headerlink" href="#censored-quantile-regression" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>If the response variable is subject to censoring, the conditional mean is not identifiable without additional distributional assumptions, but the conditional quantile is often identifiable.</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(Y^c = \max(0, Y)\)</span> and <span class="math notranslate nohighlight">\(Q_{Y|X}= X\beta_{\tau}\)</span>, then <span class="math notranslate nohighlight">\(Q_{Y^c}=\max(0, X\beta_{\tau})\)</span>. This is the censored quantile regression model: estimated values can be obtained without making any distributional assumptions, but at the cost of computational difficulty, some of which can be avoided by using a simple three step censored quantile regression procedure as an approximation.</p></li>
</ul>
<p>A number of papers that are on the early application of quantile regression:</p>
<ol class="simple">
<li><p><span id="id3">[<a class="reference internal" href="#id26" title="Moshe Buchinsky. Recent advances in quantile regression models: a practical guideline for empirical research. Journal of human resources, pages 88–126, 1998.">Buchinsky, 1998</a>]</span></p></li>
<li><p><span id="id4">[<a class="reference internal" href="#id27" title="Keming Yu and MC1614628 Jones. Local linear quantile regression. Journal of the American statistical Association, 93(441):228–237, 1998.">Yu and Jones, 1998</a>]</span></p></li>
<li><p><span id="id5">[<a class="reference internal" href="#id28" title="Xuming He, Pin Ng, and Stephen Portnoy. Bivariate quantile smoothing splines. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 60(3):537–550, 1998.">He <em>et al.</em>, 1998</a>]</span></p></li>
<li><p><span id="id6">[<a class="reference internal" href="#id30" title="Roger Koenker and Jose AF Machado. Goodness of fit and related inference processes for quantile regression. Journal of the american statistical association, 94(448):1296–1310, 1999.">Koenker and Machado, 1999</a>]</span></p></li>
<li><p><span id="id7">[<a class="reference internal" href="#id29" title="Keming Yu and Rana A Moyeed. Bayesian quantile regression. Statistics &amp; Probability Letters, 54(4):437–447, 2001.">Yu and Moyeed, 2001</a>]</span></p></li>
</ol>
<div class="docutils container" id="id8">
<dl class="citation">
<dt class="label" id="id26"><span class="brackets"><a class="fn-backref" href="#id3">Buc98</a></span></dt>
<dd><p>Moshe Buchinsky. Recent advances in quantile regression models: a practical guideline for empirical research. <em>Journal of human resources</em>, pages 88–126, 1998.</p>
</dd>
<dt class="label" id="id28"><span class="brackets"><a class="fn-backref" href="#id5">HNP98</a></span></dt>
<dd><p>Xuming He, Pin Ng, and Stephen Portnoy. Bivariate quantile smoothing splines. <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, 60(3):537–550, 1998.</p>
</dd>
<dt class="label" id="id25"><span class="brackets"><a class="fn-backref" href="#id1">KBJ78</a></span></dt>
<dd><p>Roger Koenker and Gilbert Bassett Jr. Regression quantiles. <em>Econometrica: journal of the Econometric Society</em>, pages 33–50, 1978.</p>
</dd>
<dt class="label" id="id30"><span class="brackets"><a class="fn-backref" href="#id6">KM99</a></span></dt>
<dd><p>Roger Koenker and Jose AF Machado. Goodness of fit and related inference processes for quantile regression. <em>Journal of the american statistical association</em>, 94(448):1296–1310, 1999.</p>
</dd>
<dt class="label" id="id24"><span class="brackets"><a class="fn-backref" href="#id2">YH12</a></span></dt>
<dd><p>Yunwen Yang and Xuming He. Bayesian empirical likelihood for quantile regression. <em>The Annals of Statistics</em>, 40(2):1102–1131, 2012.</p>
</dd>
<dt class="label" id="id27"><span class="brackets"><a class="fn-backref" href="#id4">YJ98</a></span></dt>
<dd><p>Keming Yu and MC1614628 Jones. Local linear quantile regression. <em>Journal of the American statistical Association</em>, 93(441):228–237, 1998.</p>
</dd>
<dt class="label" id="id29"><span class="brackets"><a class="fn-backref" href="#id7">YM01</a></span></dt>
<dd><p>Keming Yu and Rana A Moyeed. Bayesian quantile regression. <em>Statistics &amp; Probability Letters</em>, 54(4):437–447, 2001.</p>
</dd>
</dl>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Stats"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>
    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Note-Propensity%20score%20methods.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Propensity Score Methods &amp; Implementation</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Note-Sample_size_calculation_with_WMW_test.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Sample size calculation for the Wilcoxon-Mann-Whitney test adjusting for ties</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Ming Yang<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>